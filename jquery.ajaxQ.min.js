(function(f){function g(c){var a=e[c],d=a.requests.shift();d&&(a.pending++,d.ajaxOptions.dequeued&&d.ajaxOptions.dequeued(d.xhr),a=f.ajax(d.ajaxOptions),a.success(function(b,a,c){d.deferred.resolve(b,a,c)}),a.error(function(b,a,c){d.deferred.reject(b,a,c)}),a.complete(function(){e[c].pending--;g(c)}))}function i(c,a,d){var b=e[c];b.requests.push({ajaxOptions:a,deferred:d});b.pending<=b.opts.maxRequests&&g(c)}function h(c,a){var d=e[c];if(d)for(var b=0;b<d.requests.length;b++)d.requests[b].deferred==
a&&(d.requests.splice(b,1),a.reject(a,"aborted"));else throw"QueueError: queue '"+options.queue+"' is not defined.";}var e={};f.extend({ajaxQ:function(c,a){if(e.hasOwnProperty(c))throw"QueueError: queue '"+options.queue+"' is already defined.";else{var d=e,b;b=a||{};b.maxRequests=b.maxRequests||5;d[c]={pending:0,requests:[],opts:b}}},clearQ:function(c){var a=e[c];if(a)for(;a.requests.length>0;)h(c,a.requests[0].deferred);else throw"QueueError: queue '"+options.queue+"' is not defined.";}});var j=
f.ajax;f.ajax=function(c){if(c.ajaxQ){var a=c.ajaxQ;if(e.hasOwnProperty(a)){var d=f.Deferred(),b=d.promise();b.success=b.done;b.error=b.fail;b.complete=d.done;b.abort=function(){h(queueName,d)};delete c.ajaxQ;i(a,c,d);return b}else throw"QueueError: queue '"+options.queue+"' is not defined.";}else return j(c)}})(jQuery);
