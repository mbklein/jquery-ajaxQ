(function(e){function h(a){a=a||{};a.maxRequests=a.maxRequests||5;return{pending:0,requests:[],opts:a}}function i(a){var b=d[a],c=b.requests.shift();c&&(b.pending++,c.ajaxOptions.dequeued&&c.ajaxOptions.dequeued(c.xhr),b=e.ajax(c.ajaxOptions),b.success(function(a,b,d){c.deferred.resolve(a,b,d)}),b.error(function(a,b,d){c.deferred.reject(a,b,d)}),b.complete(function(){d[a].pending--;i(a)}))}var d={queue:h()};e.extend({ajaxQ:function(a,b){if(d.hasOwnProperty(a))throw"QueueError: queue '"+options.queue+
"' is already defined.";else d[a]=h(b)},clearQ:function(a){var b=d[a];if(b)for(var c=0;c<b.length;c++)for(var f=b[c].xhr,g=d[a],e=0;e<g.length;e++)g[e].deferred==f&&g.splice(e,1).deferred.reject(f,"aborted")}});var j=e.ajax;e.ajax=function(a){if(a.ajaxQ){var b=a.ajaxQ||"queue";if(d.hasOwnProperty(b)){var c=e.Deferred(),f=c.promise();f.success=f.done;f.error=f.fail;f.complete=c.done;delete a.ajaxQ;var g=d[b];g.requests.push({ajaxOptions:a,deferred:c});g.pending<=g.opts.maxRequests&&i(b);return f}else throw"QueueError: queue '"+
options.queue+"' is not defined.";}else return j(a)}})(jQuery);
