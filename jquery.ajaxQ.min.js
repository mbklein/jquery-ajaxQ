(function(f){function g(a){a=a||{};a.maxRequests=a.maxRequests||5;return{pending:0,requests:[],opts:a}}function h(a){var b=e[a],c=b.requests.shift();c&&(b.pending++,c.ajaxOptions.dequeued&&c.ajaxOptions.dequeued(c.xhr),b=f.ajax(c.ajaxOptions),b.success(function(a,b,e){c.deferred.resolve(a,b,e)}),b.error(function(a,b,e){c.deferred.reject(a,b,e)}),b.complete(function(){e[a].pending--;h(a)}))}function j(a,b,c){var d=e[a];d.requests.push({ajaxOptions:b,deferred:c});d.pending<=d.opts.maxRequests&&h(a)}
function i(a,b){var c=e[a];if(c)for(var d=0;d<c.requests.length;d++)c.requests[d].deferred==b&&(c.requests.splice(d,1),b.reject(b,"aborted"));else throw"QueueError: queue '"+options.queue+"' is not defined.";}var e={queue:g()};f.extend({ajaxQ:function(a,b){if(e.hasOwnProperty(a))throw"QueueError: queue '"+options.queue+"' is already defined.";else e[a]=g(b)},clearQ:function(a){var b=e[a||"queue"];if(b)for(;b.requests.length>0;)i(a,b.requests[0].deferred);else throw"QueueError: queue '"+options.queue+
"' is not defined.";}});var k=f.ajax;f.ajax=function(a){if(a.ajaxQ){var b=a.ajaxQ||"queue";if(e.hasOwnProperty(b)){var c=f.Deferred(),d=c.promise();d.success=d.done;d.error=d.fail;d.complete=c.done;d.abort=function(){i(queueName,c)};delete a.ajaxQ;j(b,a,c);return d}else throw"QueueError: queue '"+options.queue+"' is not defined.";}else return k(a)}})(jQuery);
