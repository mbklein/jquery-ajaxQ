(function(f){function g(a){a=a||{};a.maxRequests=a.maxRequests||5;return{pending:0,requests:[],opts:a}}function h(a){var a=e[a],b=a.requests.shift();b&&(a.pending++,f.ajax(b.ajaxOptions))}function j(a,b,c){var d=e[a];d.requests.push({ajaxOptions:b,xhr:c});d.pending<=d.opts.maxRequests&&h(a)}function i(a,b){for(var c=e[a],d=0;d<c.length;d++)c[d].xhr==b&&c.splice(d,1).xhr.abort()}var e={queue:g()};f.extend({ajaxQueue:function(a,b){if(e.hasOwnProperty(a))throw"QueueError: queue '"+options.queue+"' is already defined.";
else e[a]=g(b)},clearQueue:function(a){var b=e[a];if(b)for(var c=0;c<b.length;c++)i(a,b[c].xhr)}});f.ajaxTransport("queued",function(a,b,c){var d=a.queue||"queue";if(e.hasOwnProperty(d))return{send:function(){var b=a.complete;a.dataType=a.realDataType;a.complete=function(a,c){b(a,c);e[d].pending--;h(d)};j(d,a,c)},abort:function(){i(c)}};else throw"QueueError: queue '"+a.queue+"' is not defined.";})})(jQuery);
